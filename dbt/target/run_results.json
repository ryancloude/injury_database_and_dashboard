{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-09-22T10:00:48.917166Z", "invocation_id": "50a15e2b-5a47-4d9a-ba03-5c4fb44c8fd0", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-22T10:00:37.566061Z", "completed_at": "2025-09-22T10:00:37.595056Z"}, {"name": "execute", "started_at": "2025-09-22T10:00:37.642976Z", "completed_at": "2025-09-22T10:00:37.896210Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3628058433532715, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.pitcher_injury.stg_transactions", "compiled": true, "compiled_code": "\n\nwith src as (\n    select * from \"baseball\".\"bronze\".\"transactions\"\n)\n\nselect\n    id as trans_id,\n    date,\n    effectivedate, \n    resolutiondate,\n    typecode,\n    typedesc,\n    description, \n    person_id,  \n    toteam_id,\n    fromteam_id   \nfrom src", "relation_name": "\"baseball\".\"bronze\".\"stg_transactions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-22T10:00:37.546819Z", "completed_at": "2025-09-22T10:00:37.593274Z"}, {"name": "execute", "started_at": "2025-09-22T10:00:37.596147Z", "completed_at": "2025-09-22T10:00:37.899683Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3774387836456299, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.pitcher_injury.stg_games", "compiled": true, "compiled_code": "\n\nwith src as (\n    select * from \"baseball\".\"bronze\".\"games\"\n)\n\nselect\n    gamepk,\n    gametype,\n    season,\n    gamedate,\n    officialdate,\n    status_abstractgamestate as game_state,\n    teams_away_team_id as away_team_id,\n    teams_away_score as away_score,\n    teams_home_team_id as home_team_id,\n    teams_home_score as home_score,\n    venue_id\n\n\n    \nfrom src", "relation_name": "\"baseball\".\"bronze\".\"stg_games\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-22T10:00:37.555956Z", "completed_at": "2025-09-22T10:00:37.594246Z"}, {"name": "execute", "started_at": "2025-09-22T10:00:37.624163Z", "completed_at": "2025-09-22T10:00:37.906867Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3808720111846924, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.pitcher_injury.stg_players", "compiled": true, "compiled_code": "\n\nwith src as (\n    select * from \"baseball\".\"bronze\".\"players\"\n)\n\nselect\n    id as person_id,\n    fullname,\n    firstname,\n    lastname,\n    firstname || ' ' || lastname as secondary_name,\n    primarynumber,\n    birthdate,\n    birthcity,\n    birthstateprovince,\n    birthcountry,\n    height,\n    weight,\n    usename,\n    uselastname,\n    middlename,\n    draftyear,\n    strikezonetop,\n    strikezonebottom,\n    primaryposition_code,\n    batside_code,\n    pitchhand_code,\n    nickname\n\nfrom src", "relation_name": "\"baseball\".\"bronze\".\"stg_players\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-22T10:00:37.561074Z", "completed_at": "2025-09-22T10:00:37.601465Z"}, {"name": "execute", "started_at": "2025-09-22T10:00:37.647649Z", "completed_at": "2025-09-22T10:00:37.909501Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3811330795288086, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.pitcher_injury.stg_teams", "compiled": true, "compiled_code": "\n\nwith src as (\n    select * from \"baseball\".\"bronze\".\"teams\"\n)\n\nselect\n    id as team_id,\n    name,\n    teamcode,\n    filecode,\n    abbreviation,\n    locationname as location,\n    springleague_id,\n    springleague_name,\n    venue_id,\n    venue_name,\n    springvenue_id,\n    league_id,\n    division_id,\n    sport_id\n\nfrom src", "relation_name": "\"baseball\".\"bronze\".\"stg_teams\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-22T10:00:37.991697Z", "completed_at": "2025-09-22T10:00:38.072208Z"}, {"name": "execute", "started_at": "2025-09-22T10:00:38.110138Z", "completed_at": "2025-09-22T10:00:38.290534Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3605794906616211, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.pitcher_injury.season_dates", "compiled": true, "compiled_code": "\n\n\nwith games as (\n  -- Reuse staging instead of re-writing transforms\n  select * from \"baseball\".\"bronze\".\"stg_games\"\n),\n\nteams as (\n    select DISTINCT team_id\n    from \"baseball\".\"bronze\".\"stg_teams\"\n    where sport_id = 1\n),\n\nall_games AS (\n    -- All home games in the regular season\n    SELECT \n        season,\n        home_team_id AS team_id,\n        gamedate\n    FROM games\n    WHERE gametype != 'S' and gametype != 'E' and home_team_id in (select * from teams)\n\n    UNION ALL\n\n    -- All away games in the regular season\n    SELECT \n        season,\n        away_team_id AS team_id,\n        gamedate\n    FROM games\n    WHERE gametype != 'S' and gametype != 'E' and away_team_id in (select * from teams)\n),\n\nseason_dates as (\nselect team_id, season, min(gamedate) as first_game, max(gamedate) as last_game\nfrom all_games\ngroup by team_id, season\n)\n\nselect team_id, season, first_game,\nCASE\nwhen season = extract(year from current_date) and extract(month from current_date) < 11\nthen Null\nelse last_game\nend as last_game\nfrom season_dates", "relation_name": "\"baseball\".\"silver\".\"season_start_end\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-22T10:00:37.999947Z", "completed_at": "2025-09-22T10:00:38.078667Z"}, {"name": "execute", "started_at": "2025-09-22T10:00:38.114247Z", "completed_at": "2025-09-22T10:00:38.326843Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.36814451217651367, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.pitcher_injury.stg_statcast", "compiled": true, "compiled_code": "\n\nwith src as (\n    select * from \"baseball\".\"bronze\".\"statcast\"\n),\n\nteams as (\n        select DISTINCT team_id, abbreviation\n        from \"baseball\".\"bronze\".\"stg_teams\"\n)\n\nselect\n        game_pk,\n        at_bat_number,\n        pitch_number,\n        md5(cast(coalesce(cast(game_pk as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(at_bat_number as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pitch_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as pitch_id,\n        game_date,\n        game_year,\n        pitcher,\n        batter,\n        description,\n        events,\n        pitch_type,\n        release_speed,\n        release_spin_rate,\n        release_pos_x,\n        release_pos_z,\n        release_extension,\n        pfx_x,\n        pfx_z,\n        plate_x,\n        plate_z,\n        t1.team_id as home_team,\n        t2.team_id as away_team,\n        inning_topbot\nfrom src\nleft join teams t1\non home_team = t1.abbreviation\nleft join teams t2\non away_team = t2.abbreviation", "relation_name": "\"baseball\".\"bronze\".\"stg_statcast\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-22T10:00:37.986680Z", "completed_at": "2025-09-22T10:00:38.065152Z"}, {"name": "execute", "started_at": "2025-09-22T10:00:38.085544Z", "completed_at": "2025-09-22T10:00:38.393531Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4352147579193115, "adapter_response": {"_message": "SELECT 15520", "code": "SELECT", "rows_affected": 15520}, "message": "SELECT 15520", "failures": null, "unique_id": "model.pitcher_injury.players", "compiled": true, "compiled_code": "\n\n\nwith src as (\n  -- Reuse staging instead of re-writing transforms\n  select * from \"baseball\".\"bronze\".\"stg_players\"\n)\n\nselect *\nfrom src", "relation_name": "\"baseball\".\"silver\".\"players\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-22T10:00:37.966473Z", "completed_at": "2025-09-22T10:00:38.022519Z"}, {"name": "execute", "started_at": "2025-09-22T10:00:38.026364Z", "completed_at": "2025-09-22T10:00:38.469305Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.5235743522644043, "adapter_response": {"_message": "MERGE 376", "code": "MERGE", "rows_affected": 376}, "message": "MERGE 376", "failures": null, "unique_id": "model.pitcher_injury.transactions", "compiled": true, "compiled_code": "\n\n\nwith src as (\n  -- Reuse staging instead of re-writing transforms\n  select * from \"baseball\".\"bronze\".\"stg_transactions\"\n)\n\nselect *\nfrom src\n\n\n  -- Sliding window to pick up late corrections; change 14 -> 7/21/etc. as you like\n  where date >= current_date - interval '7 day'\n", "relation_name": "\"baseball\".\"silver\".\"transactions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-22T10:00:38.374443Z", "completed_at": "2025-09-22T10:00:38.405214Z"}, {"name": "execute", "started_at": "2025-09-22T10:00:38.408969Z", "completed_at": "2025-09-22T10:00:48.868248Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 10.50830340385437, "adapter_response": {"_message": "MERGE 28240", "code": "MERGE", "rows_affected": 28240}, "message": "MERGE 28240", "failures": null, "unique_id": "model.pitcher_injury.statcast", "compiled": true, "compiled_code": "\n\n\nwith src as (\n  -- Reuse staging instead of re-writing transforms\n  select * from \"baseball\".\"bronze\".\"stg_statcast\"\n)\n\nselect\n    pitch_id,\n    game_pk,\n   at_bat_number,\n   pitch_number,\n   game_date,\n   game_year,\n   pitcher,\n   batter,\n   description,\n   events,\n   case\n      when pitch_type in ('CS','EP','KC','CU') then 'CU'\n      when pitch_type in ('AB','FA','IN','PO','KN') or pitch_type is null then 'OT'\n      when pitch_type in ('CH','SC') then 'CH'\n      when pitch_type in ('SV','ST') then 'ST'\n      when pitch_type in ('FS','FO') then 'FS'\n      else pitch_type\n    end as pitch_type,\n   release_speed,\n   release_spin_rate,\n   release_pos_x,\n   release_pos_z,\n   release_extension,\n  -- feet -> inches like your SQL (\u00d712)\n   pfx_x   * 12 as pfx_x,\n   pfx_z   * 12 as pfx_z,\n   plate_x * 12 as plate_x,\n   plate_z * 12 as plate_z,\n   case when inning_topbot in ('Top','T') then away_team\n         when inning_topbot in ('Bot','B') then home_team\n         else null end as batter_team,\n   case when inning_topbot in ('Top','T') then home_team\n         when inning_topbot in ('Bot','B') then away_team\n         else null end as pitcher_team,\n        now()::timestamptz as silver_updated_at\nfrom src\n\n\n  -- Sliding window to pick up late corrections; change 14 -> 7/21/etc. as you like\n  where game_date >= current_date - interval '7 day'\n", "relation_name": "\"baseball\".\"silver\".\"statcast\"", "batch_results": null}], "elapsed_time": 11.683736085891724, "args": {"log_level_file": "debug", "vars": {}, "favor_state": false, "partial_parse_file_diff": true, "show_resource_report": false, "indirect_selection": "eager", "log_level": "info", "macro_debugging": false, "populate_cache": true, "require_nested_cumulative_type_params": false, "source_freshness_run_project_hooks": false, "select": ["+path:models/silver"], "version_check": true, "exclude": [], "quiet": false, "log_file_max_bytes": 10485760, "static_parser": true, "print": true, "empty": false, "log_path": "/usr/app/logs", "warn_error_options": {"include": [], "exclude": []}, "cache_selected_only": false, "send_anonymous_usage_stats": true, "invocation_command": "dbt run --select +path:models/silver", "require_batched_execution_for_custom_microbatch_strategy": false, "state_modified_compare_vars": false, "require_yaml_configuration_for_mf_time_spines": false, "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "project_dir": "/usr/app", "skip_nodes_if_on_run_start_fails": false, "require_resource_names_without_spaces": false, "introspect": true, "use_colors_file": true, "state_modified_compare_more_unrendered_values": false, "profiles_dir": "/root/.dbt", "use_colors": true, "defer": false, "strict_mode": false, "partial_parse": true, "printer_width": 80, "which": "run", "log_format_file": "debug"}}