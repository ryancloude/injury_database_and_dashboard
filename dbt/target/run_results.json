{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-09-19T15:26:09.124219Z", "invocation_id": "b5be9b88-a873-4a7a-8273-5bf5b0d4c631", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-19T15:25:54.130281Z", "completed_at": "2025-09-19T15:25:54.184695Z"}, {"name": "execute", "started_at": "2025-09-19T15:25:54.214377Z", "completed_at": "2025-09-19T15:25:54.816567Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7729499340057373, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.pitcher_injury.stg_transactions", "compiled": true, "compiled_code": "\n\nwith src as (\n    select * from \"baseball\".\"bronze\".\"transactions\"\n)\n\nselect\n    id as trans_id,\n    date,\n    effectivedate, \n    resolutiondate,\n    typecode,\n    typedesc,\n    description, \n    person_id,  \n    toteam_id,\n    fromteam_id   \nfrom src", "relation_name": "\"baseball\".\"bronze\".\"stg_transactions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-19T15:25:54.095438Z", "completed_at": "2025-09-19T15:25:54.178568Z"}, {"name": "execute", "started_at": "2025-09-19T15:25:54.186155Z", "completed_at": "2025-09-19T15:25:54.820499Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.7894775867462158, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.pitcher_injury.stg_players", "compiled": true, "compiled_code": "\n\nwith src as (\n    select * from \"baseball\".\"bronze\".\"players\"\n)\n\nselect\n    id as person_id,\n    fullname,\n    firstname,\n    lastname,\n    firstname || ' ' || lastname as secondary_name,\n    primarynumber,\n    birthdate,\n    birthcity,\n    birthstateprovince,\n    birthcountry,\n    height,\n    weight,\n    usename,\n    uselastname,\n    middlename,\n    draftyear,\n    strikezonetop,\n    strikezonebottom,\n    primaryposition_code,\n    batside_code,\n    pitchhand_code,\n    nickname\n\nfrom src", "relation_name": "\"baseball\".\"bronze\".\"stg_players\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-19T15:25:54.120791Z", "completed_at": "2025-09-19T15:25:54.200787Z"}, {"name": "execute", "started_at": "2025-09-19T15:25:54.329069Z", "completed_at": "2025-09-19T15:25:54.824051Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.7916045188903809, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.pitcher_injury.stg_teams", "compiled": true, "compiled_code": "\n\nwith src as (\n    select * from \"baseball\".\"bronze\".\"teams\"\n)\n\nselect\n    id as team_id,\n    name,\n    teamcode,\n    filecode,\n    abbreviation,\n    locationname as location,\n    springleague_id,\n    springleague_name,\n    venue_id,\n    venue_name,\n    springvenue_id,\n    league_id,\n    division_id,\n    sport_id\n\nfrom src", "relation_name": "\"baseball\".\"bronze\".\"stg_teams\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-19T15:25:54.071223Z", "completed_at": "2025-09-19T15:25:54.198508Z"}, {"name": "execute", "started_at": "2025-09-19T15:25:54.257670Z", "completed_at": "2025-09-19T15:25:54.833860Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8041293621063232, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.pitcher_injury.stg_games", "compiled": true, "compiled_code": "\n\nwith src as (\n    select * from \"baseball\".\"bronze\".\"games\"\n)\n\nselect\n    gamepk,\n    gametype,\n    season,\n    gamedate,\n    officialdate,\n    status_abstractgamestate as game_state,\n    teams_away_team_id as away_team_id,\n    teams_away_score as away_score,\n    teams_home_team_id as home_team_id,\n    teams_home_score as home_score,\n    venue_id\n\n\n    \nfrom src", "relation_name": "\"baseball\".\"bronze\".\"stg_games\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-19T15:25:54.955481Z", "completed_at": "2025-09-19T15:25:55.025640Z"}, {"name": "execute", "started_at": "2025-09-19T15:25:55.113074Z", "completed_at": "2025-09-19T15:25:55.419652Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.58778977394104, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.pitcher_injury.season_dates", "compiled": true, "compiled_code": "\n\n\nwith games as (\n  -- Reuse staging instead of re-writing transforms\n  select * from \"baseball\".\"bronze\".\"stg_games\"\n),\n\nteams as (\n    select DISTINCT team_id\n    from \"baseball\".\"bronze\".\"stg_teams\"\n    where sport_id = 1\n),\n\nall_games AS (\n    -- All home games in the regular season\n    SELECT \n        season,\n        home_team_id AS team_id,\n        gamedate\n    FROM games\n    WHERE gametype != 'S' and gametype != 'E' and home_team_id in (select * from teams)\n\n    UNION ALL\n\n    -- All away games in the regular season\n    SELECT \n        season,\n        away_team_id AS team_id,\n        gamedate\n    FROM games\n    WHERE gametype != 'S' and gametype != 'E' and away_team_id in (select * from teams)\n),\n\nseason_dates as (\nselect team_id, season, min(gamedate) as first_game, max(gamedate) as last_game\nfrom all_games\ngroup by team_id, season\n)\n\nselect team_id, season, first_game,\nCASE\nwhen season = extract(year from current_date) and extract(month from current_date) < 11\nthen Null\nelse last_game\nend as last_game\nfrom season_dates", "relation_name": "\"baseball\".\"silver\".\"season_start_end\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-19T15:25:54.933359Z", "completed_at": "2025-09-19T15:25:55.026483Z"}, {"name": "execute", "started_at": "2025-09-19T15:25:55.119688Z", "completed_at": "2025-09-19T15:25:55.456423Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6038551330566406, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.pitcher_injury.stg_statcast", "compiled": true, "compiled_code": "\n\nwith src as (\n    select * from \"baseball\".\"bronze\".\"statcast\"\n),\n\nteams as (\n        select DISTINCT team_id, abbreviation\n        from \"baseball\".\"bronze\".\"stg_teams\"\n)\n\nselect\n        game_pk,\n        at_bat_number,\n        pitch_number,\n        md5(cast(coalesce(cast(game_pk as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(at_bat_number as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pitch_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as pitch_id,\n        game_date,\n        game_year,\n        pitcher,\n        batter,\n        description,\n        events,\n        pitch_type,\n        release_speed,\n        release_spin_rate,\n        release_pos_x,\n        release_pos_z,\n        release_extension,\n        pfx_x,\n        pfx_z,\n        plate_x,\n        plate_z,\n        t1.team_id as home_team,\n        t2.team_id as away_team,\n        inning_topbot\nfrom src\nleft join teams t1\non home_team = t1.abbreviation\nleft join teams t2\non away_team = t2.abbreviation", "relation_name": "\"baseball\".\"bronze\".\"stg_statcast\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-19T15:25:54.921231Z", "completed_at": "2025-09-19T15:25:55.000834Z"}, {"name": "execute", "started_at": "2025-09-19T15:25:55.027305Z", "completed_at": "2025-09-19T15:25:55.529301Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6426942348480225, "adapter_response": {"_message": "SELECT 15514", "code": "SELECT", "rows_affected": 15514}, "message": "SELECT 15514", "failures": null, "unique_id": "model.pitcher_injury.players", "compiled": true, "compiled_code": "\n\n\nwith src as (\n  -- Reuse staging instead of re-writing transforms\n  select * from \"baseball\".\"bronze\".\"stg_players\"\n)\n\nselect *\nfrom src", "relation_name": "\"baseball\".\"silver\".\"players\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-19T15:25:54.905800Z", "completed_at": "2025-09-19T15:25:54.997236Z"}, {"name": "execute", "started_at": "2025-09-19T15:25:55.002244Z", "completed_at": "2025-09-19T15:25:55.673356Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7881503105163574, "adapter_response": {"_message": "MERGE 388", "code": "MERGE", "rows_affected": 388}, "message": "MERGE 388", "failures": null, "unique_id": "model.pitcher_injury.transactions", "compiled": true, "compiled_code": "\n\n\nwith src as (\n  -- Reuse staging instead of re-writing transforms\n  select * from \"baseball\".\"bronze\".\"stg_transactions\"\n)\n\nselect *\nfrom src\n\n\n  -- Sliding window to pick up late corrections; change 14 -> 7/21/etc. as you like\n  where date >= current_date - interval '7 day'\n", "relation_name": "\"baseball\".\"silver\".\"transactions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-19T15:25:55.553908Z", "completed_at": "2025-09-19T15:25:55.596442Z"}, {"name": "execute", "started_at": "2025-09-19T15:25:55.600129Z", "completed_at": "2025-09-19T15:26:09.065643Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 13.524448871612549, "adapter_response": {"_message": "MERGE 28131", "code": "MERGE", "rows_affected": 28131}, "message": "MERGE 28131", "failures": null, "unique_id": "model.pitcher_injury.statcast", "compiled": true, "compiled_code": "\n\n\nwith src as (\n  -- Reuse staging instead of re-writing transforms\n  select * from \"baseball\".\"bronze\".\"stg_statcast\"\n)\n\nselect\n    pitch_id,\n    game_pk,\n   at_bat_number,\n   pitch_number,\n   game_date,\n   game_year,\n   pitcher,\n   batter,\n   description,\n   events,\n   case\n      when pitch_type in ('CS','EP','KC','CU') then 'CU'\n      when pitch_type in ('AB','FA','IN','PO','KN') or pitch_type is null then 'OT'\n      when pitch_type in ('CH','SC') then 'CH'\n      when pitch_type in ('SV','ST') then 'ST'\n      when pitch_type in ('FS','FO') then 'FS'\n      else pitch_type\n    end as pitch_type,\n   release_speed,\n   release_spin_rate,\n   release_pos_x,\n   release_pos_z,\n   release_extension,\n  -- feet -> inches like your SQL (\u00d712)\n   pfx_x   * 12 as pfx_x,\n   pfx_z   * 12 as pfx_z,\n   plate_x * 12 as plate_x,\n   plate_z * 12 as plate_z,\n   case when inning_topbot in ('Top','T') then away_team\n         when inning_topbot in ('Bot','B') then home_team\n         else null end as batter_team,\n   case when inning_topbot in ('Top','T') then home_team\n         when inning_topbot in ('Bot','B') then away_team\n         else null end as pitcher_team,\n        now()::timestamptz as silver_updated_at\nfrom src\n\n\n  -- Sliding window to pick up late corrections; change 14 -> 7/21/etc. as you like\n  where game_date >= current_date - interval '7 day'\n", "relation_name": "\"baseball\".\"silver\".\"statcast\"", "batch_results": null}], "elapsed_time": 15.682094097137451, "args": {"send_anonymous_usage_stats": true, "cache_selected_only": false, "defer": false, "favor_state": false, "require_nested_cumulative_type_params": false, "empty": false, "require_batched_execution_for_custom_microbatch_strategy": false, "vars": {}, "use_colors": true, "partial_parse_file_diff": true, "profiles_dir": "/root/.dbt", "write_json": true, "strict_mode": false, "state_modified_compare_vars": false, "exclude": [], "log_format_file": "debug", "invocation_command": "dbt run --select +path:models/silver", "populate_cache": true, "printer_width": 80, "warn_error_options": {"include": [], "exclude": []}, "project_dir": "/usr/app", "which": "run", "show_resource_report": false, "quiet": false, "skip_nodes_if_on_run_start_fails": false, "use_colors_file": true, "log_file_max_bytes": 10485760, "indirect_selection": "eager", "log_format": "default", "introspect": true, "require_yaml_configuration_for_mf_time_spines": false, "print": true, "partial_parse": true, "require_explicit_package_overrides_for_builtin_materializations": true, "static_parser": true, "require_resource_names_without_spaces": false, "select": ["+path:models/silver"], "source_freshness_run_project_hooks": false, "version_check": true, "state_modified_compare_more_unrendered_values": false, "log_level_file": "debug", "log_path": "/usr/app/logs", "log_level": "info", "macro_debugging": false}}